<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>UVic Spring School 2023 - Introduction to the Julia language</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="..//img/sfu_favicon.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../img/sfudrac_logo.png" alt="SFU &amp; DRAC logos" class="navbar-logo">
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../bash/index.html">
 <span class="menu-text">Bash</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../hpc/index.html">
 <span class="menu-text">HPC</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../r_intro/index.html">
 <span class="menu-text">Intro R</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../r_parallel/index.html">
 <span class="menu-text">Parallel R</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../julia/index.html">
 <span class="menu-text">Parallel Julia</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../ml/index.html">
 <span class="menu-text">PyTorch</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../scivis/index.html">
 <span class="menu-text">ParaView</span></a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-reader-toggle nav-link" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title"><em>On this page:</em></h2>
   
  <ul>
  <li><a href="#the-julia-programming-language" id="toc-the-julia-programming-language" class="nav-link active" data-scroll-target="#the-julia-programming-language">The Julia programming language</a></li>
  <li><a href="#running-julia-locally" id="toc-running-julia-locally" class="nav-link" data-scroll-target="#running-julia-locally">Running Julia locally</a></li>
  <li><a href="#using-julia-on-supercomputers" id="toc-using-julia-on-supercomputers" class="nav-link" data-scroll-target="#using-julia-on-supercomputers">Using Julia on supercomputers</a>
  <ul>
  <li><a href="#julia-on-compute-canada-production-clusters" id="toc-julia-on-compute-canada-production-clusters" class="nav-link" data-scroll-target="#julia-on-compute-canada-production-clusters">Julia on Compute Canada production clusters</a>
  <ul>
  <li><a href="#installing-julia-packages-on-a-production-cluster" id="toc-installing-julia-packages-on-a-production-cluster" class="nav-link" data-scroll-target="#installing-julia-packages-on-a-production-cluster">Installing Julia packages on a production cluster</a></li>
  </ul></li>
  <li><a href="#julia-on-the-training-cluster-for-this-workshop" id="toc-julia-on-the-training-cluster-for-this-workshop" class="nav-link" data-scroll-target="#julia-on-the-training-cluster-for-this-workshop">Julia on the training cluster for this workshop</a></li>
  </ul></li>
  <li><a href="#running-julia-in-the-repl" id="toc-running-julia-in-the-repl" class="nav-link" data-scroll-target="#running-julia-in-the-repl">Running Julia in the REPL</a>
  <ul>
  <li><a href="#where-to-run-the-repl" id="toc-where-to-run-the-repl" class="nav-link" data-scroll-target="#where-to-run-the-repl">Where to run the REPL</a></li>
  <li><a href="#repl-modes" id="toc-repl-modes" class="nav-link" data-scroll-target="#repl-modes">REPL modes</a></li>
  <li><a href="#repl-keybindings" id="toc-repl-keybindings" class="nav-link" data-scroll-target="#repl-keybindings">REPL keybindings</a></li>
  <li><a href="#repl-for-parallel-work" id="toc-repl-for-parallel-work" class="nav-link" data-scroll-target="#repl-for-parallel-work">REPL for parallel work</a></li>
  </ul></li>
  <li><a href="#running-scripts" id="toc-running-scripts" class="nav-link" data-scroll-target="#running-scripts">Running scripts</a></li>
  <li><a href="#serial-julia-features-worth-noting-in-10-mins" id="toc-serial-julia-features-worth-noting-in-10-mins" class="nav-link" data-scroll-target="#serial-julia-features-worth-noting-in-10-mins">Serial Julia features worth noting in 10 mins</a>
  <ul>
  <li><a href="#jit-compilation" id="toc-jit-compilation" class="nav-link" data-scroll-target="#jit-compilation">JIT compilation</a></li>
  <li><a href="#macros" id="toc-macros" class="nav-link" data-scroll-target="#macros">Macros</a></li>
  <li><a href="#fun-fact" id="toc-fun-fact" class="nav-link" data-scroll-target="#fun-fact">Fun fact</a></li>
  <li><a href="#additional-basic-information" id="toc-additional-basic-information" class="nav-link" data-scroll-target="#additional-basic-information">Additional basic information</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Introduction to the Julia language</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="the-julia-programming-language" class="level2">
<h2 class="anchored" data-anchor-id="the-julia-programming-language">The Julia programming language</h2>
<ul>
<li>High-performance, dynamically typed programming language for scientific computing</li>
<li>Uses just-in-time (JIT) compiler to compile all code, includes an interactive command line (REPL = read–eval–print loop, and can also be run in Jupyter), i.e.&nbsp;tries to <strong>combine the advantages of both compiled and interpreted languages</strong></li>
<li>Built-in package manager</li>
<li>Lots of interesting design decisions, e.g.&nbsp;macros, support for Unicode, etc. — covered in <a href="https://wgtm21.netlify.app/programming_julia/">our introductory Julia course</a></li>
<li><strong>Support for parallel and distributed computing</strong> via its Standard Library and many 3rd party packages
<ul>
<li>being added along the way, e.g. <span class="citation" data-cites="threads">@threads</span> were first introduced in v0.5</li>
<li>currently under active development, both in features and performance</li>
</ul></li>
</ul>
</section>
<section id="running-julia-locally" class="level2">
<h2 class="anchored" data-anchor-id="running-julia-locally">Running Julia locally</h2>
<p>If you have Julia installed on your own computer, you can run it there: on a multi-core laptop/desktop you can launch multiple threads and processes and run them in parallel.</p>
<p>If you would like to install Julia later on, you can find some information <a href="../julia-installation">here</a>.</p>
</section>
<section id="using-julia-on-supercomputers" class="level2">
<h2 class="anchored" data-anchor-id="using-julia-on-supercomputers">Using Julia on supercomputers</h2>
<section id="julia-on-compute-canada-production-clusters" class="level3">
<h3 class="anchored" data-anchor-id="julia-on-compute-canada-production-clusters">Julia on Compute Canada production clusters</h3>
<p>Julia is among hundreds of software packages installed on the CC clusters. To use Julia on one of them, you would load the following module:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> module load julia</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="installing-julia-packages-on-a-production-cluster" class="level4">
<h4 class="anchored" data-anchor-id="installing-julia-packages-on-a-production-cluster">Installing Julia packages on a production cluster</h4>
<p>By default, all Julia packages you install from REPL will go into <code>$HOME/.julia</code>. If you want to put packages into another location, you will need to (1) install inside your Julia session with (from within Julia):</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode jl code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">empty!</span>(<span class="cn">DEPOT_PATH</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">push!</span>(<span class="cn">DEPOT_PATH</span>,<span class="st">"/scratch/path/to/julia/packages"</span>) </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>] add BenchmarkTools</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>and (2) before running Julia modify two variables (from the command line):</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> module load julia</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> export JULIA_DEPOT_PATH=/home/\$USER/.julia:/scratch/path/to/julia/packages</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> export JULIA_LOAD_PATH=@:@v#.#:@stdlib:/scratch/path/to/julia/packages</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Don’t do this on the training cluster!</strong> We already have everything installed in a central location for all guest accounts.</p>
<div class="note">
<p>Some Julia packages rely on precompiled bits that developers think would work on all architectures, but they don’t. For example, <code>Plots</code> package comes with several precompiled libraries, it installs without problem on Compute Canada clusters, but then at runtime you will see an error about “GLIBC_2.18 not found”. The proper solution would be to recompile the package on the cluster, but it is not done correctly in Julia packaging, and the error persists even after “recompilation”. There is a solution for this, and you can always contact us at support@computecanada.ca and ask for help. Another example if Julia’s <code>NetCDF</code> package: it installs fine on Apple Silicon Macs, but it actually comes with a precompiled C package that was compiled only for Intel Macs and does not work on M1.</p>
</div>
</section>
</section>
<section id="julia-on-the-training-cluster-for-this-workshop" class="level3">
<h3 class="anchored" data-anchor-id="julia-on-the-training-cluster-for-this-workshop">Julia on the training cluster for this workshop</h3>
<p>We have Julia on our training cluster <em>uu.c3.ca</em>.</p>
<div class="note">
<p>Our training cluster has:</p>
<ul>
<li>one login node with 16 <em>“persistent”</em> cores and 32GB of memory,</li>
<li>17 compute nodes with 16 <em>“compute”</em> cores and 60GB of memory (272 cores in total),</li>
<li>one GPU node with 4 <em>“compute”</em> cores, 1 vGPU (8GB) and 22GB of memory.</li>
</ul>
</div>
<p>In our introductory Julia course we use Julia inside a Jupyter notebook. Today we will be starting multiple threads and processes, with the eventual goal of running our workflows as batch jobs on an HPC cluster, so we’ll be using Julia from the command line.</p>
<blockquote class="blockquote">
<p><strong>Pause</strong>: We will now distribute accounts and passwords to connect to the cluster.</p>
</blockquote>
<p>Normally, you would install Julia packages yourself. A typical package installation however takes several hundred MBs of RAM, a fairly long time, and creates many small files. Our training cluster runs on top of virtualized hardware with a shared filesystem. If several dozen workshop participants start installing packages at the same time, this will hammer the filesystem and will make it slow for all participants for quite a while.</p>
<p>Instead, for this workshop, you will run:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> source /project/def-sponsor00/shared/julia/config/loadJulia.sh</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This script loads the Julia module and sets environment variables to point to a central environment in which we have pre-installed all the packages for this workshop.</p>
<div class="note">
<p>Note that you can still install additional packages if you want. These will install in your own environment at ~/.julia.</p>
</div>
</section>
</section>
<section id="running-julia-in-the-repl" class="level2">
<h2 class="anchored" data-anchor-id="running-julia-in-the-repl">Running Julia in the REPL</h2>
<section id="where-to-run-the-repl" class="level3">
<h3 class="anchored" data-anchor-id="where-to-run-the-repl">Where to run the REPL</h3>
<p>You could now technically launch a Julia REPL (Read-Eval-Print-Loop). However, this would launch it on the login node and if everybody does this at the same time, we would probably stall our training cluster.</p>
<p>Instead, you will first launch an interactive job by running the Slurm command <code>salloc</code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> salloc <span class="at">--mem-per-cpu</span><span class="op">=</span>3600M <span class="at">--time</span><span class="op">=</span>01:00:00</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This puts you on a compute node for up to one hour.</p>
<p>Now you can launch the Julia REPL and try to run a couple of commands:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> julia</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="ex">_</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>   <span class="ex">_</span>       _ _<span class="er">(</span><span class="ex">_</span><span class="kw">)</span><span class="ex">_</span>     <span class="kw">|</span>  <span class="ex">Documentation:</span> https://docs.julialang.org</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">(</span><span class="ex">_</span><span class="kw">)</span>     <span class="kw">|</span> <span class="kw">(</span><span class="ex">_</span><span class="kw">)</span> <span class="kw">(</span><span class="ex">_</span><span class="kw">)</span>    <span class="kw">|</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>   <span class="ex">_</span> _   _<span class="kw">|</span> <span class="kw">|</span><span class="ex">_</span>  __ _   <span class="kw">|</span>  <span class="ex">Type</span> <span class="st">"?"</span> for help, <span class="st">"]?"</span> for Pkg help.</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">|</span> <span class="kw">|</span> <span class="kw">|</span> <span class="kw">|</span> <span class="kw">|</span> <span class="kw">|</span> <span class="kw">|</span><span class="ex">/</span> _<span class="kw">`</span> <span class="kw">|</span>  <span class="kw">|</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">|</span> <span class="kw">|</span> <span class="kw">|</span><span class="ex">_</span><span class="kw">|</span> <span class="kw">|</span> <span class="kw">|</span> <span class="kw">|</span> <span class="kw">(</span><span class="ex">_</span><span class="kw">|</span> <span class="kw">|</span>  <span class="kw">|</span>  <span class="ex">Version</span> 1.7.0 <span class="er">(</span><span class="ex">2021-11-30</span><span class="kw">)</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a> <span class="ex">_/</span> <span class="kw">|</span><span class="ex">\__</span><span class="st">'_|_|_|\__'</span><span class="ex">_</span><span class="kw">|</span>  <span class="kw">|</span>  </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span><span class="ex">__/</span>                   <span class="kw">|</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="ex">julia</span><span class="op">&gt;</span> using BenchmarkTools</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="ex">julia</span><span class="op">&gt;</span> @btime sqrt<span class="er">(</span><span class="ex">2</span><span class="kw">)</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="ex">1.825</span> ns <span class="er">(</span><span class="ex">0</span> allocations: 0 bytes<span class="kw">)</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="ex">1.4142135623730951</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="repl-modes" class="level3">
<h3 class="anchored" data-anchor-id="repl-modes">REPL modes</h3>
<p>The Julia REPL has 4 modes:</p>
<p><img src="img/julia_repl_modes.png" class="img-fluid" alt="noshadow"></p>
<p>(<code>env</code> is the name of your current project environment.)</p>
</section>
<section id="repl-keybindings" class="level3">
<h3 class="anchored" data-anchor-id="repl-keybindings">REPL keybindings</h3>
<p>In the REPL, you can use standard command line (Emacs) keybindings:</p>
<pre><code>C-c     cancel
C-d     quit
C-l     clear console

C-u     kill from the start of line
C-k     kill until the end of line

C-a     go to start of line
C-e     go to end of line

C-f     move forward one character
C-b     move backward one character

M-f     move forward one word
M-b     move backward one word

C-d     delete forward one character
C-h     delete backward one character

M-d     delete forward one word
M-Backspace delete backward one word

C-p     previous command
C-n     next command

C-r     backward search
C-s     forward search</code></pre>
</section>
<section id="repl-for-parallel-work" class="level3">
<h3 class="anchored" data-anchor-id="repl-for-parallel-work">REPL for parallel work</h3>
<p>Remember our workflow to launch a Julia REPL:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run our script to load the Julia module</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># and set our special environment with pre-installed packages</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> source /project/def-sponsor00/shared/julia/config/loadJulia.sh</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Launch an interactive job on a compute node for one hour</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> salloc <span class="at">--mem-per-cpu</span><span class="op">=</span>3600M <span class="at">--time</span><span class="op">=</span>01:00:00</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Launch the Julia REPL</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> julia</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This is great to run serial work.</p>
<p>When we will run parallel work however, we will want to use multiple CPUs per task in order to see a speedup.</p>
<p>So instead, you will run:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> source /project/def-sponsor00/shared/julia/config/loadJulia.sh</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Request 2 CPUs per task from Slurm</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> salloc <span class="at">--mem-per-cpu</span><span class="op">=</span>3600M <span class="at">--cpus-per-task</span><span class="op">=</span>2 <span class="at">--time</span><span class="op">=</span>01:00:00</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Launch Julia on 2 threads</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> julia <span class="at">-t</span> 2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="running-scripts" class="level2">
<h2 class="anchored" data-anchor-id="running-scripts">Running scripts</h2>
<p>Now, if we want to get an even bigger speedup, we could use even more CPUs per task. The problem is that our cluster only has around 300 CPUs. So some of us would be left waiting for Slurm while the others can play with a bunch of CPUs for an hour.</p>
<p>This is not an efficient approach. This is equally true on production clusters: if you want to run an interactive job using a lot of resources, you might have to wait for a long time.</p>
<p>A much better approach in this case is to put our Julia code in a Julia script and run it through a batch job by using the Slurm function <code>sbatch</code>.</p>
<p>You can run a Julia script with <code>julia julia_script.jl</code>.</p>
<p>So all we need to do is to submit a shell script to <code>sbatch</code> that contains information for Slurm and the code to run (<code>julia julia_script.jl</code>).</p>
<div class="example">
<p>Example:</p>
</div>
<p>We can save into <code>job_script.sh</code>:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">#SBATCH --ntasks=1</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">#SBATCH --cpus-per-task=8</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">#SBATCH --mem-per-cpu=3600M</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#SBATCH --time=00:10:00</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="ex">julia</span> <span class="at">-t</span> 8 julia_script.jl</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Then we run our job script:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> sbatch job_script.sh</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="serial-julia-features-worth-noting-in-10-mins" class="level2">
<h2 class="anchored" data-anchor-id="serial-julia-features-worth-noting-in-10-mins">Serial Julia features worth noting in 10 mins</h2>
<section id="jit-compilation" class="level3">
<h3 class="anchored" data-anchor-id="jit-compilation">JIT compilation</h3>
<p>Programming languages are either interpreted or compiled.</p>
<p>Interpreted languages use interpreters: programs that execute your code directly (Python, for instance, uses the interpreter CPython, written in C). Interpreted languages are very convenient since you can run sections of your code as soon as you write them. However, they are slow.</p>
<p>Compiled languages use compilers: programs that translate your code into machine code. Machine code is extremely efficient, but of course, having to compile your code before being able to run it makes for less convenient workflows when it comes to writing or debugging code.</p>
<p>Julia uses <a href="https://en.wikipedia.org/wiki/Just-in-time_compilation">just-in-time compilation</a> or JIT based on <a href="https://en.wikipedia.org/wiki/LLVM">LLVM</a>: the source code is compiled at run time. This combines the flexibility of interpretation with the speed of compilation, bringing speed to an interactive language. It also allows for dynamic recompilation, continuous weighing of gains and costs of the compilation of parts of the code, and other on the fly optimizations.</p>
<p><a href="https://carolchen.me/blog/technical/jits-intro/">Here</a> is a great blog post covering this topic if you want to dive deeper into the functioning of JIT compilers.</p>
</section>
<section id="macros" class="level3">
<h3 class="anchored" data-anchor-id="macros">Macros</h3>
<p>In the tradition of Lisp, Julia has <a href="https://en.wikibooks.org/wiki/Introducing_Julia/Metaprogramming#Macros">strong metaprogramming capabilities</a>, in particular in the form of macros.</p>
<p>Macros are parsed and evaluated first, then their output gets evaluated like a classic expression. This allows the language to modify itself in a <a href="https://en.wikipedia.org/wiki/Reflective_programming">reflective</a> manner.</p>
<p>Macros have a <code>@</code> prefix and are defined with a syntax similar to that of functions.</p>
<p><code>@time</code> for instance is a macro that executes an expression and prints the execution time and other information.</p>
</section>
<section id="fun-fact" class="level3">
<h3 class="anchored" data-anchor-id="fun-fact">Fun fact</h3>
<p><a href="https://docs.julialang.org/en/v1/manual/unicode-input/">Julia supports unicode</a>. In a Julia REPL, type the following, followed by the TAB key:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="op">\:</span>snail<span class="op">:</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>and you get:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>🐌</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>While assigning values to a “snail variable” might not be all that useful, a wide access to—for instance—Greek letters, makes Julia’s code look nicely similar to the equations it represents. For instance, if you type TAB after each variable name, the following:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="op">\</span>pgamma <span class="op">=</span> ((<span class="op">\</span>alpha <span class="op">\</span><span class="cn">pi</span> <span class="op">+</span> <span class="op">\</span>beta) <span class="op">/</span> <span class="op">\</span>delta) <span class="op">+</span> <span class="op">\</span>upepsilon</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>looks like:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="cn">ɣ</span> <span class="op">=</span> ((α <span class="cn">π</span> <span class="op">+</span> β) <span class="op">/</span> δ) <span class="op">+</span> ε</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="additional-basic-information" class="level3">
<h3 class="anchored" data-anchor-id="additional-basic-information">Additional basic information</h3>
<p><a href="https://wgtm21.netlify.app/programming_julia/">Our introduction to Julia course</a> has, amongst others, sections on:</p>
<ul>
<li><a href="https://westgrid-julia.netlify.app/2021_modules/04_jl_doc/">how to access help/documentation and links to a lot of resources</a></li>
<li><a href="https://westgrid-julia.netlify.app/2021_modules/06_jl_pkg/">packages</a></li>
<li><a href="https://westgrid-julia.netlify.app/2021_modules/09_jl_collections/">collections</a></li>
<li><a href="https://westgrid-julia.netlify.app/2021_modules/10_jl_functions/">basic functions</a></li>
<li><a href="https://westgrid-julia.netlify.app/2021_modules/11_jl_control_flow/">control flow</a></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp(/https:\/\/2023uvic\.netlify\.app\//);
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">
        <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../about.html">About</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../calendar.html">Calendar</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../newsletter.html">Newsletter</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../contact.html">Contact</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://docs.alliancecan.ca/wiki/Technical_documentation">Wiki</a>
  </li>  
</ul>
      </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/WestDRI">
      <i class="bi bi-github" role="img" aria-label="WestDRI GitHub">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.youtube.com/channel/UCfgds4Qf7VFOv4ORRvFFmhw">
      <i class="bi bi-youtube" role="img" aria-label="WestDRI YouTube">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>



</body></html>